/*FICHERO PARA CREACIÓN DE BASE DE DATOS*/

/*BIEN*/
CREATE TABLE CIUDAD (
ID NUMBER(5) CONSTRAINT CIU_ID_NN NOT NULL CONSTRAINT CIU_ID_PK PRIMARY KEY,
NOMBRE VARCHAR(30) CONSTRAINT CIU_NOM_NN NOT NULL CONSTRAINT CIU_NOM_UN UNIQUE
);

/*FALTA AÑADIR LA DIRECCIÓN QUE DEBERÍA SER DE N A N*/
CREATE TABLE USUARIO(
DNI VARCHAR(9) CONSTRAINT US_DNI_NN NOT NULL CONSTRAINT US_DNI_PK PRIMARY KEY,
NOMBRE VARCHAR(25) CONSTRAINT US_NOM_NN NOT NULL CONSTRAINT US_NOM_UN UNIQUE,
APELLIDO VARCHAR(40) CONSTRAINT US_APE_NN NOT NULL CONSTRAINT US_APE_UN UNIQUE,
EMAIL VARCHAR(60) CONSTRAINT US_EM_NN NOT NULL CONSTRAINT US_EM_UN UNIQUE,
CONTRA VARCHAR(32) CONSTRAINT US_CNTR_NN NOT NULL,
FECHA_NACIMIENTO DATE CONSTRAINT US_FCHA_NAC_NN NOT NULL
);

/*BIEN*/
CREATE TABLE TIPO_DATO_BANCARIO(
ID NUMBER(2) CONSTRAINT T_DT_BAN_ID_NN NOT NULL CONSTRAINT T_DT_BAN_ID_PK PRIMARY KEY,
DENOMINACION VARCHAR (25) CONSTRAINT T_DT_BAN_DEN_NN NOT NULL CONSTRAINT T_DT_BAN_DEN_UN UNIQUE
);

CREATE TABLE DATO_BANCARIO(
NUM VARCHAR(24) CONSTRAINT DT_BAN_NUM_NN NOT NULL CONSTRAINT DAT_BAN_NUM_PK PRIMARY KEY ON DELETE CASCADE,
CVV NUMBER(3) CONSTRAINT DT_BAN_CVV_NN NOT NULL,
TIPO_DATO_BANCARIO_ID NUMBER(2) CONSTRAINT DT_BAN_TP_DT_BAN_ID_NN/*rEDUCIR TAMAÑO*/ NOT NULL CONSTRAINT DT_TP_DT_BAN_ID_FK_DT_BAN_ID REFERENCES TIPO_DATO_BANCARIO(ID) ON DELETE CASCADE,
USUARIO_DNI VARCHAR(9) CONSTRAINT DT_BAN_US_DNI_NN NOT NULL CONSTRAINT DT_BAN_US_DNI_FK_US_DNI/*rEDUCIR TAMAÑO*/ REFERENCES USUARIO(DNI) ON DELETE CASCADE
);

/*BIEN*/
CREATE TABLE PUESTO(
ID NUMBER(4) CONSTRAINT PUESTO_ID_NN NOT NULL CONSTRAINT PUESTO_ID_PK PRIMARY KEY,
DENOMINACION VARCHAR(30) CONSTRAINT PUESTO_DENOM_NN NOT NULL CONSTRAINT PUESTO_DENOM_UN UNIQUE
);

/*BIEN*/
CREATE TABLE ESTADO_PEDIDO(
ID NUMBER(2) CONSTRAINT EST_PED_ID_NN NOT NULL CONSTRAINT EST_PED_ID_PK PRIMARY KEY,
DENOMINACION VARCHAR(20) EST_PED_DENOM_NN NOT NULL CONSTRAINT EST_PED_DENOM_UN UNIQUE
);

/*BIEN*/
CREATE TABLE CODIGO_POSTAL(
CODIGO NUMBER(7) CONSTRAINT COD_PS_NN NOT NULL CONSTRAINT COD_PS_PK PRIMARY KEY,
CIUDAD_ID NUMBER(5) CONSTRAINT COD_PS_CIU_ID_NN NOT NULL CONSTRAINT COD_PS_CIU_ID_FK_CIU_ID/*rEDUCIR TAMAÑO*/ REFERENCES CIUDAD(ID) ON DELETE CASCADE
);


/*BIEN*/
CREATE TABLE DIRECCION(
ID NUMBER(9) CONSTRAINT DIR_ID_NN NOT NULL CONSTRAINT DIR_ID_PK PRIMARY KEY,
DIR VARCHAR(40) CONSTRAINT DIR_DIR_NN NOT NULL CONSTRAINT DIR_DIR_UN UNIQUE,
ID_CIUDAD NUMBER(5) CONSTRAINT DIR_CIU_ID_NN NOT NULL CONSTRAINT DIR_CIU_ID_FK_CIU_ID/*rEDUCIR TAMAÑO*/ REFERENCES CIUDAD(ID) ON DELETE CASCADE,
CODIGO_POSTAL NUMBER(7) CONSTRAINT DIR_COD_PS_NN NOT NULL CONSTRAINT DIR_COD_PS_FK_COD_PS_COD/*rEDUCIR TAMAÑO*/ REFERENCES CODIGO_POSTAL(CODIGO) ON DELETE CASCADE
);


CREATE TABLE MODELO(
ID NUMBER (9) CONSTRAINT MOD_ID_NN NOT NULL CONSTRAINT MODELO_ID_PK PRIMARY KEY,
NOMBRE VARCHAR(25) CONSTRAINT MOD_NOM_NN NOT NULL CONSTRAINT MOD_NOM_UN UNIQUE
);


CREATE TABLE CENTRO_DE_OPERACIONES(
ID NUMBER(9) CONSTRAINT CTR_OPE_ID_NN NOT NULL CONSTRAINT CTR_OPE_ID_PK PRIMARY KEY,
DENOMINACION VARCHAR(20) CONSTRAINT CTR_OPE_DENOM_NN NOT NULL
);


/**/
CREATE TABLE ALMACEN(
ID NUMBER(9) CONSTRAINT ALMA_ID_NN NOT NULL CONSTRAINT ALMA_ID_PK PRIMARY KEY,
DENOMINACION VARCHAR(20) CONSTRAINT ALMA_DENOM_NN NOT NULL,
ID_CENTRO_OPERACIONES NUMBER(9) CONSTRAINT ALMA_ID_C_OPS_NN NOT NULL CONSTRAINT ALMA_ID_CTR_OPS_FK_CTR_ID/*rEDUCIR TAMAÑO*/ REFERENCES CENTRO_DE_OPERACIONES(ID) ON DELETE CASCADE);

CREATE TABLE OFICINA(
ID NUMBER(9) CONSTRAINT OF_ID_NN NOT NULL CONSTRAINT OF_ID_PK PRIMARY KEY,
DENOMINACION VARCHAR(20) CONSTRAINT OF_DENOM_NN NOT NULL,
ID_CENTRO_OPERACIONES NUMBER(9) CONSTRAINT OF_ID_CTR_OPS_NN NOT NULL CONSTRAINT OF_ID_CTR_OPS_FK_CTR_ID/*rEDUCIR TAMAÑO*/ REFERENCES CENTRO_DE_OPERACIONES(ID) ON DELETE CASCADE
);


/**/
CREATE TABLE EMPLEADO(
DNI VARCHAR(9) CONSTRAINT EMP_DNI_NN NOT NULL CONSTRAINT EMP_DNI_PK PRIMARY KEY, 
NOMBRE VARCHAR(20) CONSTRAINT EMP_NOM_NN NOT NULL,
APELLIDOS VARCHAR (40) CONSTRAINT EMP_APE_NN NOT NULL,
FECHA_NACIMIENTO DATE CONSTRAINT EMP_FCH_NAC_NN NOT NULL,
EMAIL VARCHAR(25) CONSTRAINT EMP_EM_NN NOT NULL,
NSS NUMBER(12) CONSTRAINT EMP_NSS_NN NOT NULL,
ID_PUESTO NUMBER(4) CONSTRAINT EMP_ID_PST_NN NOT NULL CONSTRAINT EMP_ID_PST_FK_ID_PST/*rEDUCIR TAMAÑO*/ REFERENCES PUESTO(ID) ON DELETE CASCADE,
ID_OFICINA NUMBER(9) CONSTRAINT EMP_ID_OFI_NN NOT NULL CONSTRAINT EMP_ID_OFI_FK_ID_OFI/*rEDUCIR TAMAÑO*/ REFERENCES OFICINA(ID)ON DELETE CASCADE,
ID_ALMACEN NUMBER(9) CONSTRAINT EMP_ID_ALMA_NN NOT NULL CONSTRAINT EMP_ID_ALMA_FK_ID_ALMA/*rEDUCIR TAMAÑO*/ REFERENCES ALMACEN(ID)ON DELETE CASCADE,
ID_DIRECCION NUMBER(9) CONSTRAINT EMP_ID_DIR_NN NOT NULL CONSTRAINT EMP_ID_DIR_FK_ID_DIR REFERENCES DIRECCION(ID)ON DELETE CASCADE,
DNI_JEFE VARCHAR(9) CONSTRAINT DNI_JEFE_NN NOT NULL CONSTRAINT EMP_DNI_JEFE_FK_EMP_DNI_JEFE/*rEDUCIR TAMAÑO*/ REFERENCES EMPLEADO(DNI) ON DELETE CASCADE /*AQUÍ HE PUESTO QUE REFERENCIA A SU PROPIA ENTIDAD*/
);

/**/
CREATE TABLE PEDIDO(
ID NUMBER(15) CONSTRAINT PED_ID_NN NOT NULL CONSTRAINT PED_ID_PK PRIMARY KEY,
DESCRIPCION VARCHAR(100),
FECHA_PEDIDO DATE CONSTRAINT PED_FCHA_NN NOT NULL,
ESTADO_PEDIDO_ID NUMBER(2) CONSTRAINT PED_EST_PED_NN NOT NULL CONSTRAINT PED_EST_PEDID_FK_EST_PED_ID/*rEDUCIR TAMAÑO*/ REFERENCES ESTADO_PEDIDO(ID),
NUM_DATO_BANCARIO VARCHAR(24) CONSTRAINT PED_NUM_DT_BAN_NN NOT NULL CONSTRAINT PED_NUM_DT_BAN_FK_DT_BAN_NUM /*rEDUCIR TAMAÑO*/REFERENCES DATO_BANCARIO(NUM)ON DELETE CASCADE,
DNI_EMPLEADO VARCHAR(9) CONSTRAINT PED_DNI_EMP_NN NOT NULL CONSTRAINT PED_DNI_EMP_FK_EMP_DNI/*rEDUCIR TAMAÑO*/ REFERENCES EMPLEADO(DNI)ON DELETE CASCADE,
DNI_USUARIO VARCHAR(9) CONSTRAINT PED_DNI_US_NN NOT NULL CONSTRAINT PEDIDO_DNIUSUARIO_FK_USUARIO_DNI/*rEDUCIR TAMAÑO*/ REFERENCES USUARIO(DNI)ON DELETE CASCADE,
ID_DIRECCION NUMBER(9) CONSTRAINT PED_DIR_ID_NN NOT NULL CONSTRAINT PEDIDO_DIR_ID_FK_DIRECCION_ID/*rEDUCIR TAMAÑO*/ REFERENCES DIRECCION(ID) ON DELETE CASCADE
);

/**/
CREATE TABLE PRODUCTO(
ID NUMBER (9) CONSTRAINT PRO_ID_NN NOT NULL CONSTRAINT PRO_ID_PK PRIMARY KEY,
DESCRIPCION VARCHAR(45) CONSTRAINT PRO_DESC_NN NOT NULL,
/*aQUÍ*/
NOMBRE VARCHAR(25) CONSTRAINT PRO_NOMBRE_NONULO NOT NULL CONSTRAINT PRODUCTO_NOMBRE_UNICO UNIQUE,
PRECIO NUMBER (6) CONSTRAINT PRODUCTO_PRECIO_NONULO NOT NULL,
ID_MODELO NUMBER(9)  CONSTRAINT PRODUCTO_MODELO_ID_NONULO NOT NULL CONSTRAINT PRODUCTO_MODELO_ID_FK_MODELO_ID/*rEDUCIR TAMAÑO*/ REFERENCES MODELO(ID) ON DELETE CASCADE
);

/*PRODUCTO Y PEDIDO*/

/**/
CREATE TABLE RECLAMACION_QUEJA( 
ID NUMBER(9) CONSTRAINT RC_QJ_ID_NN NOT NULL CONSTRAINT RC_QJ_ID_PK PRIMARY KEY,
DENOMINACION  VARCHAR(20) CONSTRAINT RC_QJ_DENOM_NN NOT NULL,
NUM_RECLAMACION NUMBER (9) CONSTRAINT RC_QJ_NUM_REC_NN CONSTRAINT RC_QJ_NUM_REC_UN UNIQUE,
DESCRIPCION VARCHAR(25) CONSTRAINT RC_QJ_DESC_NN NOT NULL,
ID_PEDIDO NUMBER(15) CONSTRAINT RC_QJ_ID_PED_NN NOT NULL CONSTRAINT RECLAMACION_QUEJA_IDPEDIDO_FK_PEDIDO_ID/*rEDUCIR TAMAÑO*/ REFERENCES PEDIDO(ID) ON DELETE CASCADE,
DNI_EMPLEADO VARCHAR(9) CONSTRAINT RC_QJ_DNI_EMP_NN NOT NULL CONSTRAINT RECLAMACION_QUEJA_DNI_EMPLEADO_FK_EMPLEADO_DNI/*rEDUCIR TAMAÑO*/ REFERENCES EMPLEADO(DNI) ON DELETE CASCADE
);

/*REVISAR*/
CREATE TABLE DISPONIBILIDAD(
ID_MODELO NUMBER(9) CONSTRAINT DISPONIBILIDAD_ID_MODELO_NONULO NOT NULL CONSTRAINT DISPONIBILIDAD_ID_MODELO_FK_MODELO_ID /*rEDUCIR TAMAÑO*/REFERENCES MODELO(ID) ON DELETE CASCADE,
ID_ALMACEN NUMBER(9) CONSTRAINT DISPONIBILIDAD_ID_ALMACEN_NUNULO NOT NULL CONSTRAINT DISPONIBILIDAD_ID_ALMACEN_FK_ALMACEN_ID /*rEDUCIR TAMAÑO*/REFERENCES ALMACEN(ID) ON DELETE CASCADE,
CANTIDAD NUMBER(9) CONSTRAINT DISPONIBILIDAD_CANTIDAD_CERO_PORDEFECTO DEFAULT 0,
PRIMARY KEY ( ID_MODELO, ID_ALMACEN )
);

/*REVISAR*/
CREATE TABLE DOMICILIO_EMPLEADO(
ID_DIRECCION NUMBER(9) CONSTRAINT VIVE_EN_ID_DIRECCION_NONULO NOT NULL CONSTRAINT VIVE_EN_ID_DIRECCION_FK_ID_DIRECCION/*rEDUCIR TAMAÑO*/ REFERENCES DIRECCION(ID) ON DELETE CASCADE,
DNI_EMPLEADO VARCHAR(9) CONSTRAINT VIVE_EN_DNI_EMPLEADO_NONULO NOT NULL CONSTRAINT VIVE_EN_DNI_EMPLEADO_FK_DNI_EMPLEADO/*rEDUCIR TAMAÑO*/ REFERENCES EMPLEADO(DNI) ON DELETE CASCADE,
PRIMARY KEY ( ID_DIRECCION, DNI_EMPLEADO )
);

/*REVISAR*/
CREATE TABLE DOMICILIO_USUARIO(
DNI_USUARIO VARCHAR(9) CONSTRAINT DIR_DEL_USUARIO_DNI_NO_NULO NOT NULL CONSTRAINT DIR_DEL_USUARIO_DNI_USUARIO_FK_DNI_USUARIO/*rEDUCIR TAMAÑO*/ REFERENCES USUARIO(DNI) ON DELETE CASCADE,
ID_DIRECCION NUMBER(9) CONSTRAINT DIR_DEL_USUARIO_ID_DIRECCION_NONULO NOT NULL DIR_DEL_USUARIO_ID_DIRECCION_FK_ID_DIRECCION/*rEDUCIR TAMAÑO*/ REFERENCES DIRECCION(ID) ON DELETE CASCADE,
PRIMARY KEY(DNI_USUARIO,ID_DIRECCION)

);


